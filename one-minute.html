<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>å¿ƒèš 1 åˆ†é˜ï½œHeartHub Studio å¿ƒèšåŠ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- ç«™å…§æ¨£å¼ / å­—å‹ -->
  <link rel="stylesheet" href="css/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600&display=swap" rel="stylesheet">

  <!-- SDK / å…±ç”¨è…³æœ¬ï¼šé †åºå¾ˆé‡è¦ï¼ -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script defer src="js/shared-layout.js"></script>
  <script defer src="js/shared-dialog.js"></script>
  <script defer src="js/app.js"></script>
  <!-- æœ¬é ç¨ç«‹è…³æœ¬ -->
  <script defer src="js/one-minute.js"></script>

  <!-- æœ¬é æ¨£å¼ï¼ˆç²¾ç°¡ï¼‰ -->
  <style>
    :root{ --brand:#0ea5e9; --brand-ink:#075985; --ink:#1f2937; --muted:#6b7280;
           --bg:#f8fafc; --card:#ffffff; --ring:rgba(14,165,233,.35);
           --radius:14px; --shadow:0 6px 24px rgba(15,23,42,.08); }
    html,body{ height:100%; }
    body{ margin:0; background:var(--bg); color:var(--ink);
          font-family: system-ui,-apple-system,"Noto Serif TC","PingFang TC","Microsoft JhengHei",Segoe UI,Roboto,Helvetica,Arial,sans-serif; line-height:1.6; }
    .container{ max-width:960px; margin-inline:auto; padding:24px 16px 120px; }
    .page-hero{ background:linear-gradient(135deg,#e0f2fe 0%,#f0f9ff 100%);
                border:1px solid #e5f3ff; border-radius:18px; padding:18px 16px; margin-bottom:16px;
                display:flex; align-items:center; gap:12px; }
    .page-hero .emoji{ font-size:28px; } .page-hero h1{ font-size:20px; margin:0; letter-spacing:.5px; }
    .muted{ color:var(--muted); } .mono{ font-family: ui-monospace,Menlo,Consolas,monospace; }
    .card{ background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:18px; border:1px solid #eef2f7; }
    .flow-sm>*+*{ margin-top:8px; } .flow-md>*+*{ margin-top:12px; } .flow-lg>*+*{ margin-top:18px; }

    .pill-group{ display:flex; flex-wrap:wrap; gap:8px; }
    .pill{ border-radius:999px; padding:8px 14px; border:1px solid #dbe7f3; background:#fff; cursor:pointer; font-weight:600; letter-spacing:.5px; transition:.2s; user-select:none; }
    .pill:hover{ transform:translateY(-1px); } .pill[aria-pressed="true"]{ background:var(--brand); color:#fff; border-color:var(--brand); }

    .ctrl-grid{ display:grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap:12px; }
    .field label{ font-weight:600; display:block; margin-bottom:6px; color:#0f172a; }
    .input, textarea, select{ width:100%; border:1px solid #dbe7f3; border-radius:12px; padding:12px; outline:0; background:#fff; font-size:15px; }
    .input:focus, textarea:focus, select:focus{ box-shadow:0 0 0 4px var(--ring); border-color:var(--brand); }

    .scale{ display:flex; gap:8px; flex-wrap:wrap; }
    .scale input{ position:absolute; opacity:0; pointer-events:none; }
    .scale .opt{ display:inline-flex; align-items:center; justify-content:center; min-width:44px; height:44px; padding:0 14px; border-radius:12px; border:1px solid #dbe7f3; background:#fff; cursor:pointer; font-weight:700; transition:.2s; user-select:none; }
    .scale .opt:hover{ transform:translateY(-1px); }
    .scale input:checked + .opt{ background:#effaff; border-color:var(--brand); outline:2px solid var(--brand); outline-offset:-2px; }

    .legend{ display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; }
    .legend strong{ font-size:16px; } .hint{ font-size:13px; color:var(--muted); }

    .nps-row{ display:flex; flex-wrap:wrap; gap:8px; }
    .nps-row .opt{ min-width:40px; height:40px; }

    .toolbar{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .btn{ display:inline-flex; align-items:center; justify-content:center; gap:8px; border-radius:12px; border:1px solid #dbe7f3; padding:10px 14px; background:#fff; cursor:pointer; font-weight:700; transition:.2s; }
    .btn:hover{ transform:translateY(-1px); } .btn.primary{ background:var(--brand); color:#fff; border-color:var(--brand); }
    .btn.secondary{ background:#f3f7fb; } .btn.ok{ background:#ecfdf5; border-color:#a7f3d0; }

    .progress{ height:10px; background:#eef2f7; border-radius:999px; overflow:hidden; }
    .progress>span{ display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--brand) 0%,#22d3ee 100%); transition:width .25s ease; }

    .dock{ position:fixed; bottom:16px; left:0; right:0; z-index:20; display:flex; justify-content:center; pointer-events:none; }
    .dock-inner{ pointer-events:auto; background:#ffffffd9; backdrop-filter: blur(8px); border:1px solid #e5effa; border-radius:14px; box-shadow:var(--shadow); padding:10px; width:min(920px,calc(100% - 24px)); display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .dock small{ color:var(--muted); }
    .hidden{ display:none !important; }

    fieldset.group{ border:0; padding:0; margin:0; }
    fieldset.group + fieldset.group{ margin-top:16px; }
    fieldset.group .card{ padding:16px; }

    .count{ font-size:12px; color:var(--muted); }
    .alert{ border-radius:12px; padding:12px; border:1px solid transparent; }
    .alert.ok{ background:#ecfdf5; border-color:#a7f3d0; }
    .alert.danger{ background:#fef2f2; border-color:#fecaca; }
    .state-result{ display:flex; align-items:center; gap:10px; font-size:18px; }
    .state-result .big{ font-size:26px; }

    @media (max-width:480px){
      .page-hero h1{ font-size:18px; }
      .scale .opt{ flex:1; }
      .nps-row .opt{ flex:0 0 calc(10% - 8px); }
    }
  </style>
</head>
<body>
  <main class="container flow-lg">
    <section class="page-hero">
      <div class="emoji">ğŸŒ¿</div>
      <div>
        <h1>å¿ƒèš 1 åˆ†é˜</h1>
        <div class="muted">åªè¦ 60 ç§’ï¼Œè¨˜éŒ„ä½ çš„ç‹€æ…‹ï¼Œç´¯ç©æˆã€Œå¿ƒèšæŒ‡æ¨™ã€å ±å‘Šã€‚</div>
      </div>
    </section>

    <!-- A. æ§åˆ¶å° -->
    <section class="card flow-md" aria-labelledby="ctrl-title">
      <div class="legend"><h2 id="ctrl-title" style="margin:0;font-size:18px;">å¿«é€Ÿåˆ‡æ›</h2></div>
      <div class="pill-group" role="group" aria-label="æ™‚é–“é»">
        <button class="pill" data-tp="pre"  aria-pressed="true">èª²å‰</button>
        <button class="pill" data-tp="post" aria-pressed="false">èª²å¾Œ</button>
        <button class="pill" data-tp="72h"  aria-pressed="false">72 å°æ™‚è¿½è¹¤</button>
      </div>
      <div class="ctrl-grid" style="margin-top:10px;">
        <label class="field">èª²ç¨‹ IDï¼ˆå¯ç•™ç©ºï¼‰
          <input id="ctrl-course" class="input" type="number" inputmode="numeric" placeholder="ä¾‹å¦‚ 55">
        </label>
        <label class="field">å ´æ¬¡ IDï¼ˆå¯ç•™ç©ºï¼‰
          <input id="ctrl-session" class="input" type="number" inputmode="numeric" placeholder="ä¾‹å¦‚ 101">
        </label>
      </div>
    </section>

    <!-- é€²åº¦æ¢ -->
    <section class="card flow-sm" aria-live="polite">
      <div style="display:flex; align-items:center; justify-content:space-between;">
        <div><strong>å®Œæˆåº¦</strong> <span id="progress-text" class="muted">0 / 4</span></div>
        <button id="btn-fill-3" class="btn ok" type="button" title="ä¸€éµå¡« 3 åˆ†ï¼ˆéƒ½é‚„å¥½ï¼‰">ä¸€éµå¡« 3 åˆ†</button>
      </div>
      <div class="progress"><span id="progress-bar" style="width:0%"></span></div>
    </section>

    <!-- B. è¡¨å–®æœ¬é«” -->
    <section class="card">
      <header class="flow-sm">
        <h2 style="margin:0;">å¿ƒèš 1 åˆ†é˜ï¼ˆ<span id="tp-label">èª²å‰</span>ï¼‰</h2>
        <p class="muted" style="margin:0;">åˆ†æ•¸è¶Šé«˜ä»£è¡¨ç‹€æ…‹è¶Šç†æƒ³ã€‚è«‹ç›´è¦ºé¸æ“‡ã€‚</p>
      </header>

      <form id="one-minute-form" class="flow-md">
        <input type="hidden" name="timepoint" id="timepoint" value="pre">
        <input type="hidden" name="session_id" id="session_id">
        <input type="hidden" name="course_id"  id="course_id">

        <fieldset class="group">
          <div class="card">
            <div class="legend"><strong>1ï¼‰ç©©å®šåº¦</strong><span class="hint">1 ä¸ç©© â†’ 5 å¾ˆç©©</span></div>
            <div class="scale" role="radiogroup" aria-label="ç©©å®šåº¦">
              <label><input type="radio" name="stability" value="1" required><span class="opt">1</span></label>
              <label><input type="radio" name="stability" value="2"><span class="opt">2</span></label>
              <label><input type="radio" name="stability" value="3"><span class="opt">3</span></label>
              <label><input type="radio" name="stability" value="4"><span class="opt">4</span></label>
              <label><input type="radio" name="stability" value="5"><span class="opt">5</span></label>
            </div>
          </div>

          <div class="card">
            <div class="legend"><strong>2ï¼‰å£“åŠ›å¾©åŸ</strong><span class="hint">1 å¹¾ä¹ç„¡æ³•å¾©åŸ â†’ 5 å¾ˆå¿«èƒ½å¾©åŸ</span></div>
            <div class="scale" role="radiogroup" aria-label="å£“åŠ›å¾©åŸ">
              <label><input type="radio" name="recovery" value="1" required><span class="opt">1</span></label>
              <label><input type="radio" name="recovery" value="2"><span class="opt">2</span></label>
              <label><input type="radio" name="recovery" value="3"><span class="opt">3</span></label>
              <label><input type="radio" name="recovery" value="4"><span class="opt">4</span></label>
              <label><input type="radio" name="recovery" value="5"><span class="opt">5</span></label>
            </div>
          </div>

          <div class="card">
            <div class="legend"><strong>3ï¼‰ç¤¾æœƒé€£çµ</strong><span class="hint">1 å¾ˆç–é›¢ â†’ 5 å¾ˆé€£çµ</span></div>
            <div class="scale" role="radiogroup" aria-label="ç¤¾æœƒé€£çµ">
              <label><input type="radio" name="connectedness" value="1" required><span class="opt">1</span></label>
              <label><input type="radio" name="connectedness" value="2"><span class="opt">2</span></label>
              <label><input type="radio" name="connectedness" value="3"><span class="opt">3</span></label>
              <label><input type="radio" name="connectedness" value="4"><span class="opt">4</span></label>
              <label><input type="radio" name="connectedness" value="5"><span class="opt">5</span></label>
            </div>
          </div>

          <div class="card">
            <div class="legend"><strong>4ï¼‰å°ˆæ³¨åŠ›</strong><span class="hint">1 å¾ˆé›£å°ˆå¿ƒ â†’ 5 å¾ˆèƒ½å°ˆå¿ƒ</span></div>
            <div class="scale" role="radiogroup" aria-label="å°ˆæ³¨åŠ›">
              <label><input type="radio" name="focus" value="1" required><span class="opt">1</span></label>
              <label><input type="radio" name="focus" value="2"><span class="opt">2</span></label>
              <label><input type="radio" name="focus" value="3"><span class="opt">3</span></label>
              <label><input type="radio" name="focus" value="4"><span class="opt">4</span></label>
              <label><input type="radio" name="focus" value="5"><span class="opt">5</span></label>
            </div>
          </div>
        </fieldset>

        <fieldset class="group">
          <div class="card">
            <div class="legend"><strong>5ï¼‰ä½ é¡˜æ„æ¨è–¦é€™å ‚èª²å—ï¼Ÿ</strong><span id="nps-hint" class="hint">0ï¼ˆå®Œå…¨ä¸æœƒï¼‰â€“ 10ï¼ˆä¸€å®šæœƒï¼‰</span></div>
            <div class="nps-row" role="radiogroup" aria-label="NPS">
              <label><input type="radio" name="nps" value="0" required><span class="opt">0</span></label>
              <label><input type="radio" name="nps" value="1"><span class="opt">1</span></label>
              <label><input type="radio" name="nps" value="2"><span class="opt">2</span></label>
              <label><input type="radio" name="nps" value="3"><span class="opt">3</span></label>
              <label><input type="radio" name="nps" value="4"><span class="opt">4</span></label>
              <label><input type="radio" name="nps" value="5"><span class="opt">5</span></label>
              <label><input type="radio" name="nps" value="6"><span class="opt">6</span></label>
              <label><input type="radio" name="nps" value="7"><span class="opt">7</span></label>
              <label><input type="radio" name="nps" value="8"><span class="opt">8</span></label>
              <label><input type="radio" name="nps" value="9"><span class="opt">9</span></label>
              <label><input type="radio" name="nps" value="10"><span class="opt">10</span></label>
            </div>
          </div>
        </fieldset>

        <fieldset class="group">
          <div class="card">
            <div class="legend"><strong>6ï¼‰ä»Šå¤©æœ€å¤§çš„æ”¶ç©«</strong><span class="hint">60 å­—ä»¥å…§</span></div>
            <textarea name="one_line" rows="2" maxlength="60" class="input" placeholder="ä¾‹ï¼šæˆ‘å­¸æœƒç”¨ 3 åˆ†é˜å‘¼å¸è®“è‡ªå·±å®‰å®š"></textarea>
            <div class="count"><span id="one-line-count">0</span> / 60</div>
          </div>
        </fieldset>

        <fieldset id="post-only-actions" class="group">
          <div class="card">
            <div class="legend"><strong>7ï¼‰æ¥ä¸‹ä¾† 72 å°æ™‚ä½ æœƒåšï¼š</strong><span class="hint">å¯è¤‡é¸</span></div>
            <div class="toolbar">
              <label><input type="checkbox" name="next_actions" value="breathing_3m"> 3 åˆ†é˜å‘¼å¸</label>
              <label><input type="checkbox" name="next_actions" value="horticulture_5m"> 5 åˆ†é˜åœ’è—ç…§è­·</label>
              <label><input type="checkbox" name="next_actions" value="art_10m"> 10 åˆ†é˜è—è¡“å¡—é´‰</label>
              <label><input type="checkbox" name="next_actions" value="gratitude_colleague"> å’ŒåŒäº‹/å®¶äººäº’ç›¸æ„Ÿè¬</label>
              <label>å…¶ä»–ï¼š<input type="text" name="next_actions_other" maxlength="40" class="input" style="width:220px;"></label>
            </div>
          </div>
        </fieldset>

        <fieldset id="post-only-scope" class="group">
          <div class="card">
            <div class="legend"><strong>8ï¼‰ä½ æœƒæŠŠç·´ç¿’å¸¶åˆ°ï¼š</strong><span class="hint">å¯è¤‡é¸</span></div>
            <div class="toolbar">
              <label><input type="checkbox" name="adoption_scope" value="self"> å€‹äºº</label>
              <label><input type="checkbox" name="adoption_scope" value="family"> å®¶äºº</label>
              <label><input type="checkbox" name="adoption_scope" value="coworkers"> åŒäº‹/åŒå­¸</label>
              <label><input type="checkbox" name="adoption_scope" value="community"> ç¤¾åœ˜/ç¤¾ç¾¤</label>
            </div>
          </div>
        </fieldset>

        <fieldset id="h72-only" class="group">
          <div class="card">
            <div class="legend"><strong>7ï¼‰é€™ 72 å°æ™‚ä½ å®Œæˆäº†å“ªäº›è¡Œå‹•ï¼Ÿ</strong><span class="hint">å¯è¤‡é¸</span></div>
            <div class="toolbar">
              <label><input type="checkbox" name="actions_done" value="breathing_3m"> 3 åˆ†é˜å‘¼å¸</label>
              <label><input type="checkbox" name="actions_done" value="horticulture_5m"> 5 åˆ†é˜åœ’è—ç…§è­·</label>
              <label><input type="checkbox" name="actions_done" value="art_10m"> 10 åˆ†é˜è—è¡“å¡—é´‰</label>
              <label><input type="checkbox" name="actions_done" value="gratitude_colleague"> å’ŒåŒäº‹/å®¶äººäº’ç›¸æ„Ÿè¬</label>
              <label>å…¶ä»–ï¼š<input type="text" name="actions_done_other" maxlength="40" class="input" style="width:220px;"></label>
            </div>
          </div>
        </fieldset>

        <!-- è¡¨å–®è¨Šæ¯ / æˆæœé¡¯ç¤º -->
        <div id="form-msg" class="alert hidden" role="status" aria-live="polite"></div>
      </form>
    </section>
  </main>

  <!-- åº•éƒ¨æµ®å‹•é€å‡ºåˆ—ï¼ˆæ•´åˆ è¿”å› / é‡å¡« / é€å‡ºï¼‰ -->
  <div class="dock">
    <div class="dock-inner">
      <div>
        <strong>å¿ƒèš 1 åˆ†é˜ï½œ<span id="dock-tp">èª²å‰</span></strong>
        <div class="muted" id="dock-meta">èª²ç¨‹ï¼šâ€”ã€€å ´æ¬¡ï¼šâ€”</div>
      </div>
      <div class="toolbar">
        <small id="dock-status">å°šæœªå¡«å¯«</small>
        <button id="dock-back"  class="btn">è¿”å›</button>
        <button id="dock-reset" class="btn secondary">é‡å¡«</button>
        <button id="dock-submit" class="btn primary">é€å‡º</button>
      </div>
    </div>
  </div>
</body>
</html>
